<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">

<head>
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-37346108-11"></script>
	<script>
		window.dataLayer = window.dataLayer || [];

		function gtag() {
			dataLayer.push(arguments);
		}
		gtag('js', new Date());

		gtag('config', 'UA-37346108-11');
	</script>

	<title>Jasmine :3</title>

	<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<link rel="shortcut icon" type="image/png" href="favicons/.-8823-favicon.png">
	<script src="js/.-5214-dayjs.min.js"></script>
	<link rel="stylesheet" href="css/countdown-countdownStyle.css">
	<style>
		html {
			background-color: #dddddd;
			background: #dddddd;
			background-repeat: repeat;
			background-size: auto 100%;
			background-position: center top;
			background-attachment: fixed;
		}

		body,
		input[type="text"],
		input[type="number"],
		input[type="date"],
		input[type="time"],
		input[type="button"] {
			font-family: "Open Sans", "Open Sans", "Roboto", sans-serif;
		}
		.cd p {
			color: #00796b;
		}
	</style>
</head>

<body>
	
	<div id="content">
		<h2>Jasmine :3</h2>

		<div class="cd">
			<p id="days" class="d">64</p>
			<p id="daysLabel" class="l">DAYS</p>
		</div>
		<div class="cd">
			<p id="hours" class="d">14</p>
			<p id="hoursLabel" class="l">HOURS</p></div>
		<div class="cd">
			<p id="minutes" class="d">6</p>
			<p id="minutesLabel" class="l">MINUTES</p>
		</div>
		<div class="cd">
			<p id="seconds" class="d">41</p>
			<p id="secondsLabel" class="l">SECONDS</p>
		</div>

		<p id="date">..</p>

		<p id="timezone">..</p>

		<input type="button" onclick="changeTimezone();" value="Change Timezone" id="changeTzButton">
	</div>
	<a href="?d=20250418T0000&amp;tz=%2B1&amp;msg=Jasmine%20%3A3&amp;font=Open%20Sans&amp;fontColor=%2300796b&amp;bg=%23dddddd&amp;create.html" class="home">+</a>
	<script src="js/.-8430-countdown.js"></script>

	<script>
		var tzHour = '',tzMin = '';
		function checkTzValue(input, onblur) {
			var val = input.value.split(':');
		  
			var h = val[0].match(/^([+-](\d+)?)?$/);
			if (h == null) {
				input.value = tzHour;
				tzMin = '';
				return;
			}
		  
			h = parseInt(h[0]);
			if (isNaN(h) || (h <= 14 && h >= -12)) {
			  	tzHour = val[0];
			} else {
				input.value = tzHour;
				tzMin = '';
				return;
			}
		  
			if (val.length == 1) {
			  	return;
			} else if (Math.abs(h) != 9 && Math.abs(h) != 3 && !(h > 3 && h <= 6) && h != 8 && h != 10 && h != 12) {
				input.value = tzHour;
				return;
			}
		  
			var m = val[1];
			if (h == 8 || h == 12) {
				if (m.match(/^(4(5)?)?$/) != null) {
					tzMin = onblur ? '45' : m;
				}
			} else if (h == 5) {
				if (m.match(/^4(5)?$/) != null) {
					tzMin = onblur ? '45' : m;
				} else if (m.match(/^3(0)?$/) != null) {
					tzMin = onblur ? '30' : m;
				} else {
					tzMin = m.length == 2 ? m.match(/^\d/)[0] : '';
				}
			} else if (m.match(/^(3(0)?)?$/) != null) {
			  	tzMin = onblur ? '30' : m;
			} else if (onblur) {
			  	tzMin = '';
			}
		  
			if (onblur && tzMin != '30' && tzMin != '45') {
			  	input.value = tzHour;
			} else {
			  	input.value = tzHour + ':' + tzMin;
			}
		}

		function convertOffsetNotation(dotNotation) {
			//Convert . notation to : in the #utcInput
			var hours = Math.trunc(dotNotation);
			hours = (hours >= 0) ? "+" + hours : hours;
			var minutes = Math.trunc((Math.abs(dotNotation) % 1) * 60);
			document.querySelector("#utcInput").value = hours + (minutes == 0 ? '' : ":" + minutes);
			tzHours = hours;
			tzMin = (minutes == 0) ? '' : minutes;
			checkTzValue(document.querySelector("#utcInput"), true);
		}

		function setLocalDate() {
			var countdownDate = new Date("2025/04/18 00:00");
			var countdownTimezone = (!0) ? 1 : (new Date().getTimezoneOffset()) / (-60);
			var hOffset = timezoneDiff - countdownTimezone;
			countdownDate.setTime(countdownDate.getTime() + (hOffset * 60 * 60 * 1000));
			document.querySelector("#date").innerHTML = "Countdown to " + dayjs(countdownDate).format("dddd, MMM D, YYYY h:mm A");
			return countdownDate;
		}

		function getTimezone() {
			// if valid date
			if ("2025/04/18 00:00" != "unset") {
				var tz = Intl.DateTimeFormat().resolvedOptions().timeZone;
				timezoneDiff = (new Date().getTimezoneOffset()) / (-60);
				countdownDate = setLocalDate();
				tz = tz + checkDST();
				document.querySelector("#timezone").innerHTML = timezoneDiff >= 0 ? "Timezone: " + tz + " (UTC&#x2060;+" + timezoneDiff + ")." : "Timezone: " + tz + " (UTC&#x2060;" + timezoneDiff + ").";
				countdown(countdownDate);
			} else {
				var tz;
				if (0) {
					tz = new Date().getTimezoneOffset() / (-60);
				} else {
					tz = 1;
				}
				convertOffsetNotation(tz);
				resizeCountdowns();
			}
		}

		function changeTimezone() {
			if (document.body.contains(document.querySelector("#utcInput"))) {
				checkTzValue(document.querySelector("#utcInput"), true);
				document.querySelector("#changeTzButton").value = "Change Timezone";
				var input = document.querySelector("#utcInput").value.split(':');
				var h = parseInt(input[0]);
				if (isNaN(h)) { h = 0; }
				var min = '';
				if (input.length == 2) { min = input[1]; }
				document.getElementById("timezone").innerHTML = "Timezone: " + "UTC&#x2060;" + 
					(h >= 0 ? '+' + h : h) + (min == '' ? '' : ':' + min) + ".";
				timezoneDiff = h + (min == '' ? 0 : parseInt(min) / 60);
				setLocalDate();
			} else {
				document.querySelector("#timezone").innerHTML = "Timezone: UTC" + 
					"<input type='text' onkeyup='checkTzValue(this,false)' onblur='checkTzValue(this,true)' value='' id='utcInput'> " +
					"<a href='#' class='tooltip'>?" +
					"<span class='tooltiptext'>UTC-Offset must be a valid timezone for example -6 or +5:30.\n" +
					"";
				convertOffsetNotation(timezoneDiff);
				document.querySelector("#changeTzButton").value = "Set Timezone";
				document.querySelector("#utcInput").focus();
				document.querySelector("#utcInput").select();
				document.querySelector("#utcInput").addEventListener('keyup', function(e) {
					if (e.keyCode == 13 || e.which == 13) {
						changeTimezone();
					}
				});
			}
		}

		function checkDST() {
			var today = new Date();
			return today.dst() ? " DST" : "";
		}

		Date.prototype.stdTimezoneOffset = function() {
			var jan = new Date(this.getFullYear(), 0, 1);
			var jul = new Date(this.getFullYear(), 6, 1);
			return Math.max(jan.getTimezoneOffset(), jul.getTimezoneOffset());
		}

		Date.prototype.dst = function() {
			return this.getTimezoneOffset() < this.stdTimezoneOffset();
		}

		function updateBackground(e) {
			var value = e.value;
			var html = document.querySelector("html");
			if (/^#([0-9A-F]{3}|[0-9A-F]{6})$/gi.test(value)) {
				html.style.background = value;
			} else if (/^http/gi.test(value)) {
				html.style.background = "url(" + value + ")";
				html.style.backgroundRepeat = "repeat";
				html.style.backgroundSize = "auto 100%";
				html.style.backgroundPosition = "center top";
				html.style.backgroundAttachment = "fixed";
			}
		}

		window.onload = function() {
			getTimezone();
		}
	</script>

</body>

</html>
